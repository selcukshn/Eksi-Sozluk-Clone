@page "/"
@inject IEntryRequestService entryService;

<PageTitle>ekşi sözlük - kutsal bilgi kaynağı</PageTitle>

<ResponseView State="@State">
    <ResponseSuccess>
        @if (Entries.Any())
        {
            foreach (var entry in Entries)
            {
                <EntryView Content="@entry.Content" CreatedDate="@entry.CreatedDate" Subject="@entry.Subject" Url="@entry.Url"
                    Username="@entry.Username" />
            }
        }
    </ResponseSuccess>
    <ResponseNotFound>

    </ResponseNotFound>
    <ResponseError>

    </ResponseError>
</ResponseView>

@code {
    List<MainPageViewModel> Entries = new List<MainPageViewModel>();
    ApplicationState State = new ApplicationState(ResponseStatus.Waiting);
    protected override async Task OnInitializedAsync()
    {
        var response = await entryService.GetMainPageEntriesAsync(new MainPageEntriesQuery() { Random = true });
        State.SetResponse(response);
        if (response.IsSuccess)
            Entries = await response.ResultAsync<List<MainPageViewModel>>();
    }
}