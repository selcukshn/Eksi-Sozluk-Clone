@page "/"
@inject IRequestService requestService;

<PageTitle>Index</PageTitle>

<ResponseView State="@State">
    <ResponseSuccess>
        @if (Entries.Any())
        {
            foreach (var entry in Entries)
            {
                <EntryComponent Content="@entry.Content" CreatedDate="@entry.CreatedDate" Subject="@entry.Subject"
                    Url="@entry.Url" Username="@entry.Username" IsPage="@false" />
            }
        }
    </ResponseSuccess>
</ResponseView>

@code {
    List<AllEntryViewModel> Entries = new List<AllEntryViewModel>();
    ApplicationState State = new ApplicationState(ResponseStatus.Waiting);
    protected override async Task OnInitializedAsync()
    {
        var response = await requestService.GetAsync("/api/entry/main?random=true");
        State.SetResponse(response);
        if (response.IsSuccess)
            Entries = await response.ResultAsync<List<AllEntryViewModel>>();
    }
}